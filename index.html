<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Race randomizer</title>

<style>
    body {
        font-family: Arial, sans-serif;
        padding: 30px;
        background-image: url("background.jpg");
        background-size: cover;
        background-repeat: no-repeat;
        background-position: center;
        background-attachment: fixed;;
    }

    h1 { text-align: center; }

    .container {
        max-width: 1000px;
        margin: auto;
        background: #353434;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

  #races {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
}
    .race {
        display: flex;
        gap: 10px;
        margin-bottom: 10px;
        padding: 10px;
        background: #6d6c68;
        border-radius: 6px;
    }

    .race input {
        flex: 1;
        padding: 6px;
    }

    .race button {
        background: #ff4d4d;
        border: none;
        color: white;
        padding: 6px 10px;
        cursor: pointer;
        border-radius: 4px;
    }

    .controls {
        display: flex;
        gap: 10px;
        margin: 15px 0;
    }

    .controls input {
        flex: 1;
        padding: 8px;
    }

    button.main {
        width: 100%;
        padding: 12px;
        background: #4a90e2;
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 16px;
        cursor: pointer;
    }

    button.add {
        width: 100%;
        padding: 8px;
        margin-bottom: 15px;
        background: #6bbf59;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
    }

    .result {
        margin-top: 20px;
        background: #eef1f5;
        padding: 15px;
        border-radius: 6px;
        white-space: pre-line;
        font-weight: bold;
        display: grid;
        grid-template-columns: 1fr 1fr;
    }
    .result-block {
    background: #f0f0f0;
    padding: 10px 15px;
    border-radius: 8px;
    margin-bottom: 10px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.result-block h3 {
    margin: 0 0 8px 0;
    font-size: 16px;
}

.result-block ul {
    margin: 0;
    padding-left: 20px;
}

.result-block ul li {
    margin-bottom: 4px;
}
</style>
</head>

<body>


<div class="container">

    <div id="races"></div>

    <button class="add" onclick="addRace()">‚ûï Add race</button>
<button class="main" onclick="loadPreset()">3x3 Unification random</button>

    <div class="controls">
        <input type="number" id="players" placeholder="Number of races (players)">
        <input type="number" id="points" placeholder="Max cost">
           <label style="color:white;">
        –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:
        <span id="resultCountValue">1</span>
    </label>
    <input type="range" id="resultCount" min="1" max="10" value="1">
    </div>

    <button class="main" onclick="generate()">üé≤ Random</button>

    <div class="result" id="result"></div>

</div>

<script>
const STORAGE_KEY = "race_randomizer_data";

const slider = document.getElementById("resultCount");
const sliderValue = document.getElementById("resultCountValue");

slider.addEventListener("input", () => {
    sliderValue.textContent = slider.value;
    saveData();
});

function saveData() {
    const races = [];
    document.querySelectorAll(".race").forEach(div => {
        const inputs = div.querySelectorAll("input");
        races.push({
            name: inputs[0].value,
            cost: inputs[1].value
        });
    });

    const data = {
        races,
        players: document.getElementById("players").value,
        points: document.getElementById("points").value
    };

    resultCount: slider.value
    
    localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
}

function loadData() {
    const data = JSON.parse(localStorage.getItem(STORAGE_KEY));
    
    if (data && data.races) {
        data.races.forEach(r => addRace(r.name, r.cost));
    }
    document.getElementById("players").value = data?.players || "";
    document.getElementById("points").value = data?.points || "";

    const slider = document.getElementById("resultCount");
    const sliderValue = document.getElementById("resultCountValue");
    
    if (data && data.resultCount) {
        slider.value = data.resultCount;
    } else {
        slider.value = 1; 
    }
    sliderValue.textContent = slider.value;
}


function addRace(name = "", cost = "") {
    const div = document.createElement("div");
    div.className = "race";

    div.innerHTML = `
        <input placeholder="Race" value="${name}" oninput="saveData()">
        <input type="number" placeholder="Cost" value="${cost}" oninput="saveData()">
        <button onclick="this.parentElement.remove(); saveData()">‚úñ</button>
    `;

    document.getElementById("races").appendChild(div);
    saveData();
}

function generate() {
    saveData();

    const raceDivs = document.querySelectorAll(".race");
    const players = parseInt(document.getElementById("players").value);
    const target = parseInt(document.getElementById("points").value);
    const result = document.getElementById("result");
    let races = [];

    raceDivs.forEach(div => {
        const inputs = div.querySelectorAll("input");
        const name = inputs[0].value.trim();
        const cost = parseInt(inputs[1].value);
        if (name && !isNaN(cost)) {
            races.push({name, cost});
        }
    });

    if (isNaN(players) || players <= 0 || isNaN(target) || target <= 0 || players > races.length) {
        result.innerHTML = "";
        return;
    }

    function combinations(arr, k, start = 0, prev = []) {
        let res = [];
        if (prev.length === k) return [prev];
        for (let i = start; i < arr.length; i++) {
            res = res.concat(combinations(arr, k, i + 1, prev.concat(arr[i])));
        }
        return res;
    }

    const valid = combinations(races, players).filter(c =>
        c.reduce((s, r) => s + r.cost, 0) === target
    );

    if (valid.length === 0) {
        result.innerHTML = "There are no suitable combinations";
        return;
    }

    const count = parseInt(document.getElementById("resultCount").value);
    valid.sort(() => Math.random() - 0.5);
    const selected = valid.slice(0, Math.min(count, valid.length));

   
    result.innerHTML = ""; 

    selected.forEach((combo, index) => {
        const block = document.createElement("div");
        block.className = "result-block";

        const title = document.createElement("h3");
        title.textContent = `Result ${index + 1}`;
        block.appendChild(title);

        const list = document.createElement("ul");
        let sum = 0;

        combo.forEach(r => {
            const li = document.createElement("li");
            li.textContent = `${r.name} ‚Äî ${r.cost} cost`;
            list.appendChild(li);
            sum += r.cost;
        });

        block.appendChild(list);

        const total = document.createElement("p");
        total.textContent = `Total: ${sum} cost`;
        total.style.fontWeight = "bold";
        block.appendChild(total);

        result.appendChild(block);
    });
}


window.onload = () => {
    loadData();
    if (document.querySelectorAll(".race").length === 0) {
    }
};

function loadPreset() {
    const preset = [
        {name:"Adeptus Mechanicus", cost:4},
        {name:"Death Guard", cost:4},
        {name:"Necrons", cost:4},
        {name:"Renegade Guard", cost:4},
        {name:"Steel Legion", cost:4},
        {name:"Vostroya", cost:4},
        {name:"13th Company", cost:4},
        {name:"Chaos Marines", cost:4},
        {name:"Raven Guard", cost:4},
        {name:"Daemon Hunters", cost:3},
        {name:"Emperors Children", cost:3},
        {name:"Harlequins", cost:3},
        {name:"Eldar", cost:3},
        {name:"Tau Empire", cost:3},
        {name:"Orks", cost:3},
        {name:"Dark Eldar", cost:3},
        {name:"Chaos Daemons", cost:3},
        {name:"Ynnari (without hornets)", cost:3},
        {name:"Salamanders", cost:3},
        {name:"Blood Angels", cost:2},
        {name:"Dark Angels", cost:2},
        {name:"Imperial Fists", cost:2},
        {name:"Night Lords", cost:2},
        {name:"Sisters of Battle", cost:2},
        {name:"Thousand Sons", cost:2},
        {name:"Krieg", cost:2},
        {name:"Space Marines", cost:2},
        {name:"Imperial Guard", cost:2},
        {name:"Farsight Enclaves", cost:2},
        {name:"Witch Hunters", cost:2},
        {name:"Praetorian Guard", cost:1},
        {name:"Fallen Angels", cost:1},
        {name:"Black Templars", cost:1}
    ];

    document.getElementById("races").innerHTML = "";

    preset.forEach(r => addRace(r.name, r.cost));

    saveData();
}

</script>

</body>
</html>

















